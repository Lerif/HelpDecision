<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core">
<h:head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script
src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="http://getbootstrap.com/dist/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="../css/custom.css" type="text/css" />
<link rel="stylesheet" href="../css/bootstrap/bootstrap.css"
type="text/css" media="all" />
<link rel="stylesheet" href="../css/custom.css" type="text/css" />
<link rel="stylesheet" href="../css/bootstrap/bootstrap-theme.css"
type="text/css" media="all" />
<link rel="script" href="../css/bootstrap/bootstrap-theme.css"
type="text/css" media="all" />
<script src="../dist/js/alertify.min.js"></script>
<link rel="stylesheet" href="../css/alertify.min.css" />
<link rel="stylesheet" href="../css/themes/default.min.css" />

<title>Upload | Help Decision</title>
</h:head>

<h:body>
<nav class="navbar navbar-default">
<div class="container-fluid">
<!-- Brand e toggle agrupados para melhor visualização em mobiles -->
<div class="navbar-header">
<button type="button" class="navbar-toggle collapsed"
data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"
aria-expanded="false">
<span class="sr-only">Barra de Navegação</span> <span
class="icon-bar"></span> <span class="icon-bar"></span> <span
class="icon-bar"></span>
</button>
</div>

    <div class="collapse navbar-collapse"
        id="bs-example-navbar-collapse-1">
        <p class="navbar-text">Help Decision</p>
        <ul class="nav navbar-nav navbar-right">

            <li data-toggle="modal" data-target="#modal_sobre"><a href="#">Sobre</a></li>
            <div class="col-lg-6 col-sm-6 col-3 btn btn-md">
                <a href="home.xhtml"> <h:commandButton
                        class="btn btn-warning pull-left btn-md m-t-md" value="Dashboard" />
                </a>
            </div>
        </ul>
    </div>

</div>
</nav>

<h3 class="text-primary">Upload</h3>
<br></br>

<div class="container">
    <div class="login-box well">
        <h:form id="formLogin" enctype="multipart/form-data">
            <div class="dropdown">
                <!-- converter="#{servidorConverter}" -->
                <h:selectOneMenu value="#{uploadBean.itemSelecionado}"
                    class="btn btn-default">
                    <f:selectItem itemLabel="Selecione um Servidor" />
                    <f:selectItems value="#{uploadBean.comboServidores}" />
                    <!-- var="servidor" itemLabel="#{servidor.label}" -->
                </h:selectOneMenu>
                ou
                <button type="button" class="btn btn-md btn-primary"
                    id="botaoCadastre" data-toggle="modal"
                    data-target="#cadastra_servidor">Cadastre um Novo</button>
            </div>
            <div class="form-group">
                <label class="control-label"><br></br> <br></br> Arquivo de
                    log .tar.gz:</label><br></br>
                <h:inputFile value="#{uploadBean.arquivo}" />
            </div>
            <div class="form-group">
                <label for="portas"><h:outputText class="cadastroProduto"
                        value="Comentários:" /></label>
                <h:inputText id="comentario" placeholder="text" type="text"
                    class="form-control" value="#{uploadBean.comentarioArquivo}" />
            </div>

            <p id="mostrarMensagemServidor"></p>

            <br></br>
            <h:messages id="msg" style="color:blue" layout="table" />
            <br></br>
            <div class="form-group">

                <h:commandButton type="submit"
                    class="btn btn-success btn-login-submit btn-md m-t-md"
                    value="Upload" action="#{uploadBean.upload}" />

            </div>
        </h:form>
    </div>
</div>
<div class='col-md-3'></div>

<div class="container">
    <div class="row">


        <div class="col-md-12">
            <h3 class="text-center text-primary">Histórico de Arquivos</h3>
            <div class="table-responsive">
                <h:form>
                    <h:dataTable id="historico"
                        class="table table-bordred table-striped"
                        value="#{uploadBean.listaArquivoLog}" var="arquivoLog">

                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="Nome" />
                            </f:facet>
                            <h:outputText value="#{arquivoLog.nomeArquivo}" />
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="Data Upload" />
                            </f:facet>
                            <h:outputText value="#{arquivoLog.dataUpload}" />
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="Descrição" />
                            </f:facet>
                            <h:outputText value="#{arquivoLog.descricao}" />
                        </h:column>

                        <h:column>

                            <f:facet name="header">Delete</f:facet>

                            <h:commandLink value="Delete"
                                action="#{uploadBean.deleteAction(arquivoLog)}" />

                        </h:column>

                    </h:dataTable>
                </h:form>

            </div>

        </div>
    </div>
</div>

<!--  Modal excluir arquivo anterior  -->
<div class="modal fade" id="delete" tabindex="-1" role="dialog"
    aria-labelledby="edit" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                    aria-hidden="true">
                    <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                </button>
                <h4 class="modal-title custom_align" id="Heading">Excluir</h4>
            </div>
            <div class="modal-body">

                <div class="alert alert-danger">
                    <span class="glyphicon glyphicon-warning-sign"></span> Você tem
                    certeza que deseja excluir este Registro?
                </div>

            </div>
            <div class="modal-footer ">
                <button type="button" class="btn btn-success">
                    <span class="glyphicon glyphicon-ok-sign"></span> Sim
                </button>
                <button type="button" class="btn btn-default" data-dismiss="modal">
                    <span class="glyphicon glyphicon-remove"></span> Não
                </button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
</h:body>

<!-- Modal Cadastrar novo servidor -->
<div id="cadastra_servidor" class="modal fade" role="dialog">
<div class="modal-dialog">
<h:form id="formCadastraServidor">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal">&times;</button>
<h4 class="modal-title">Cadastrar Novo Servidor</h4>
</div>
<div class="modal-body">
<label for="variavelDeServidor"><h:outputText
id="servidorLabel" value="Nome do Servidor:" /></label>

                <h:inputText id="nomeServidor" value="#{uploadBean.nomeServidor}"
                    type="text" class="form-control" required="true"
                    requiredMessage="Por gentiliza, preencha um nome para o novo Servidor" />

                <div class="form-group">
                    <h:messages id="msgErro" style="color: red" layout="table" />
                </div>
                <div class="form-group">


                    <div class="modal-footer">
                        <h:commandButton
                            onclick="setTimeout(confirmarCadastroServidor(), delay)"
                            id="botaoConfirmar"
                            class="btn btn-success btn-login-submit btn-md pull-right m-t-md"
                            value="Confirmar" action="#{uploadBean.cadastrarServidor()}">
                        </h:commandButton>
                    </div>
                </div>
            </div>
        </div>
    </h:form>
</div>
</div>

<!-- Modal Sobre-->
<div class="modal fade" id="modal_sobre" tabindex="-1" role="dialog"
aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="modalSobre">Help Decision</h4>
</div>
<div class="modal-body">
<b>Desenvolvido por:</b><br></br> Jovens Profissionais "Doberman"<br></br>
<br></br> <b>Equipe:</b><br></br> Gabriel Rado<br></br> Guilherme
Bury<br></br> Gustavo Daneluti<br></br> Thales Rocha<br></br> Thiago
Osiro
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
</div>
</div>
</div>
</div>

<script>

    function confirmarCadastroServidor(boolean textoConfirmacaoServidor) {
        var imprimirTextoConfirmacao
        imprimirTextoConfirmacao = textoConfirmacaoServidor;

        if (imprimirTextoConfirmacao == true) {
            var notification = alertify.notify('Servidor cadastrado!', 'success', 5, function(){  console.log('dismissed'); });
        } else {
            var notification = alertify.notify('Servidor NÃO cadastrado!', 'error', 5, function(){  console.log('dismissed'); });
        }
        setTimeout(confirmarCadastroServidor, delay)
    }
    var delay = 200;
    setTimeout(confirmarCadastroServidor, delay)

</script>
</html>
